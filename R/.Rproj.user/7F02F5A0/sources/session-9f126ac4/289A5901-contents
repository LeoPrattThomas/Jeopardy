library(tidyverse,readr)

#run this first!!!!!!!!!
toDate <- function(year, month, day) {
  ISOdate(year, month, day)
}

download.file('https://www.ncei.noaa.gov/orders/cdo/3208454.csv', 'snow.csv') #no londer works
snow <- read.csv('datasets/snow.csv') %>% 
  separate( 
    col = DATE, 
    into = c("Year", "Month","Day"), 
    sep = "-",
    convert = TRUE,
  ) %>% 
  mutate(DATE = toDate(Year,Month, Day))
View(snow)
write.table(snow , file = "datasets/TidySnow.csv")


"""
AWND - Average wind speed
SNOW - Snowfall
PGTM - Peak gust time
TMAX - Maximum temperature
WESD - Water equivalent of snow on the ground
TAVG - Average Temperature.
TMIN - Minimum temperature
WESF - Water equivalent of snowfall
PRCP - Precipitation
SNWD - Snow depth

SNWD, TMAX
i think the sow depth is related to the current temputure, becuse of how well it sticks

SNOW, SNWD
i am sure the snow deapth is related to the amoudn of snow fall

SNOW, WESD
i am sure the snow deapth is related to the amoudn of watter on the ground


compare
SNOW, TAVG
PRCP, TAVG
when the tempitre increses the snow amound changes
"""

#i think the sow depth is related to the current temputure, becuse of how well it sticks
snow %>% ggplot(aes(x = SNWD, y = TMAX))+
  geom_smooth()+
  labs(
    title = "Snow depth vs. Maximum temperature",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
  ) + 
  xlab("Snow depth (in)")+
  ylab("Maximum temperature (F)")+
  theme_classic()



#with dots
snow %>% ggplot(aes(x = SNWD, y = TMAX))+
  geom_point()+ geom_smooth(color = "white")+
  labs(
    title = "Snow depth vs. Maximum temperature",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
  ) + 
  xlab("Snow depth (in)")+
  ylab("Maximum temperature (F)")+
  theme_classic()
#the snow depas is around the smae relitive tpo the tempiture but slower



#i am sure the snow deapth is related to the amoudn of snow fall
snow %>% ggplot(aes(SNOW, SNWD))+
  geom_smooth() +
  labs(
    title = "Snowfall vs. Snow depth",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
  ) + 
  xlab("Snowfall (in)")+
  ylab("Snow depth (in)")+
  theme_classic()

#i am sure the snow deapth is related to the amoudn of watter on the ground
snow %>% ggplot(aes(SNOW, WESD))+
  geom_smooth() +
  labs(
    title = "Snowfall vs. Water on the ground",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
  ) + 
  xlab("Snowfall (in)")+
  ylab("Water equivalent of snow on the ground (in)")+
  theme_classic()


colors <- c("Snowfall" = "blue", "Precipitation" = "dark blue")

snow %>% 
  filter(PRCP != 0, SNOW != 0) %>% 
  ggplot()+
  labs(
    title = "Snowfall vs. Rain with diffrent Temps",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
    color = "Type of Downfall"
  ) + 
  geom_smooth(aes(SNOW, TAVG,color = "Snowfall"))+
  geom_smooth(aes(PRCP, TAVG,color = "Precipitation")) +
  xlab("Snowfall and Precipitation (in)")+
  ylab("Average Temperature (F)")+
  theme_classic() +
  scale_color_manual(values = colors)

#as the tempitire increses it swithses from rain to snow
colors <- c("Snowfall" = "blue", "Precipitation" = "dark blue")
snow %>%#min temp
  filter(PRCP != 0, SNOW != 0) %>% 
  ggplot(aes(y = TMAX)) +
  labs(
    title = "Shift between rainfall and snow Temp",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
    color = "Type of Downfall",
    x = "Snowfall and Precipitation (in)",
    y = "Maximum temperature (F)",
  ) +
  geom_point(aes(x = SNOW, color = "Snowfall")) +
  geom_point(aes(x = PRCP, color = "Precipitation")) +
  theme_classic() + 
  scale_color_manual(values = colors)

#avrage temp
snow %>% 
  filter(PRCP > .05, SNOW > .05) %>% 
  ggplot(aes(y = TAVG)) +
  labs(
    title = "Shift between rainfall and snow Temp",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
    color = "Type of Downfall",
    x = "Snowfall and Precipitation (in)",
    y = "Average temperature (F)",
  ) +
  geom_jitter(aes(x = SNOW, color = "Snowfall")) +
  geom_jitter(aes(x = PRCP, color = "Precipitation")) +
  theme_classic() + 
  scale_color_manual(values = colors)

#avrage temp
snow %>% 
  filter(PRCP != 0, SNOW != 0) %>% 
  ggplot(aes(x = TMIN)) +
  labs(
    title = "Shift between rainfall and snow Temp",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
    color = "Type of Downfall",
    x = "Snowfall and Precipitation (in)",
    y = "Minimum temperature (F)",
  ) +
  geom_point(aes(y = SNOW, color = "Snowfall")) +
  geom_point(aes(y = PRCP, color = "Precipitation")) +
  theme_classic() + 
  scale_color_manual(values = colors)




snow %>% 
  ggplot(aes(x = DATE)) +
  geom_smooth(aes(y = SNOW, color = "Snowfall")) +
  geom_smooth(aes(y = PRCP, color = "Precipitation")) +
  scale_color_manual(values = colors)

snow %>% 
  #filter(Year == 2020, Month == 3) %>% 
  ggplot(aes(x = DATE)) +
  geom_point(aes(y = SNOW, color = "Snowfall")) +
  geom_point(aes(y = PRCP, color = "Precipitation")) +
  scale_color_manual(values = colors)

colors <- c("Snowfall" = "light grey", "Precipitation" = "dark blue")

snow %>% 
  #filter(Year == 2020, Month == 3) %>% 
  ggplot(aes(x = TMAX)) +
  geom_point(aes(y = SNOW, color = "Snowfall")) +
  geom_point(aes(y = PRCP, color = "Precipitation")) +
  theme_classic() + 
  labs(
    title = "Shift between rainfall and snow Temp",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
    color = "Type of Downfall",
    y = "Snowfall and Precipitation (in)",
    x = "Maximum temperature (F)",
  ) +
  scale_color_manual(values = colors)



snow %>% 
  filter(SNOW != 0) %>% 
  ggplot(aes(x = TMAX)) +
  geom_point(aes(y = SNOW, color = "Snowfall")) +
  theme_classic() + 
  labs(
    title = "Snowfall vs. Temp",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
    color = "Type of Downfall",
    y = "Snowfall (in)",
    x = "Maximum temperature (F)",
  )# +
  #scale_color_manual(values = colors)

snow %>% 
  filter(SNOW != 0) %>% 
  ggplot(aes(x = TMAX)) +
  geom_point(aes(y = SNOW, color = "light grey")) +
  theme_classic() + 
  labs(
    title = "Snowfall vs. Temp",
    subtitle = "(2020-2023)",
    caption = "Data from NOAA weather: https://www.ncdc.noaa.gov",
    color = "Type of Downfall",
    y = "Snowfall (in)",
    x = "Maximum temperature (F)",
  ) +
  scale_color_manual(values = colors)

#compare
#SNOW, TAVG
#PRCP, TAVG
#when the tempitre increses the snow amound changes